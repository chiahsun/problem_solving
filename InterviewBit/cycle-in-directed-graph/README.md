Tricky for stack(non-recursive) version.
