Use union find data structure.
